import{d as ue,r as C,u as me,a as h,b as pe,c as fe,e as O,f as r,g as _,h as s,i as n,w as l,j as _e,k as z,F as R,l as S,m as ve,n as y,o as ye,p as c,q as a,s as w,t as B,v as b,x as G,y as ke,z as ge,A as he}from"./index-BOzQeMJb.js";const be={class:"d-flex align-center justify-center"},xe={style:{width:"600px"}},Ce={key:0},ze={key:1},we={key:0},Ee={key:0,class:"position-relative"},Pe={class:"position-sticky top-0 mt-n4 pt-4 bg-background",style:{"z-index":"1"}},Ve={class:"d-flex align-center"},$e={key:0},Re={key:1},Be={class:"ml-4"},De={key:1,class:"pa-4"},je={class:"d-flex align-center justify-space-evenly flex-wrap"},Se={key:2},Ie={class:"d-flex align-center justify-space-between"},Ne={key:0},Te={key:0},Le={key:1},qe={key:1},Fe={key:0},Ue={key:1},Ae={key:1},Me={key:1},Je=ue({__name:"RoomView",setup(Oe){const g=localStorage.getItem("device"),k=ve().params.id,E=C(null),D=C(!1),I=C(""),P=C(!1),H=C(5e3),{data:d,pending:J,error:K}=me(h(y,"theplanningpoker",k)),{data:u,pending:Q,error:W}=pe(fe(y,"theplanningpoker",k,"participants"));let j=O(()=>!d.value||!u.value?null:d.value.status==="hide"?T(u.value.slice()):L(u.value.slice())),N=O(()=>{if(!d.value||!u.value||d.value.status==="hide")return null;let e=T(u.value.slice());e=L(e.slice());const t=e.reduce((i,m)=>(m.estimate?i.includes(m.estimate)||i.push(m.estimate):i.includes("null")||i.push("null"),i),[]),p={};return t.forEach(i=>p[i]=e.filter(m=>!m.estimate&&i==="null"||m.estimate&&i===m.estimate)),p});function T(e){return e.sort((t,p)=>t.name.localeCompare(p.name))}function L(e){return e.sort((t,p)=>q(t.estimate)-q(p.estimate))}function q(e){return e?e==="?"?1:e==="0"?2:e==="1"?3:e==="2"?4:e==="3"?5:e==="5"?6:e==="8"?7:8:0}function F(e){return e?e==="?"?"mdi-help":e==="0"?"mdi-numeric-0":e==="1"?"mdi-numeric-1":e==="2"?"mdi-numeric-2":e==="3"?"mdi-numeric-3":e==="5"?"mdi-numeric-5":e==="8"?"mdi-numeric-8":"mdi-plus":"mdi-minus"}async function X(){D.value=!0;const e=h(y,"theplanningpoker",k,"participants",g);await ke(e,{name:E.value,estimate:null}),D.value=!1}async function Y(e){const t=h(y,"theplanningpoker",k,"participants",e);await ge(t)}async function Z(e){if(!e)return;const t=he(y),p=h(y,"theplanningpoker",k);t.update(p,{status:e==="hide"?"show":"hide"}),e==="show"&&u.value&&u.value.length&&u.value.forEach(i=>{if(i.estimate){const m=h(y,"theplanningpoker",k,"participants",i.id);t.update(m,{estimate:null})}}),await t.commit()}async function v(e){if(!e)return;const t=h(y,"theplanningpoker",k,"participants",g);await ye(t,{estimate:e})}function ee(e){navigator.clipboard.writeText(window.location.origin+"/"+e),I.value="¡Link copiado!",P.value=!0}function te(e,t){return e!=="hide"?"primary":"accent"}function ne(e,t){return e==="hide"?"plain":"flat"}return(e,t)=>{const p=c("v-skeleton-loader"),i=c("v-btn"),m=c("v-toolbar"),oe=c("v-card-title"),ie=c("v-card-item"),f=c("v-icon"),ae=c("v-badge"),se=c("v-chip"),V=c("v-card-text"),$=c("v-card"),le=c("v-text-field"),re=c("v-card-actions"),ce=c("v-menu"),U=c("v-empty-state"),de=c("v-snackbar");return a(),r(R,null,[_("main",null,[_("div",be,[_("div",xe,[s(J)||s(Q)?(a(),r("div",Ce,[n(p,{type:"heading, ossein, subtitle"})])):(a(),r("div",ze,[!s(K)&&!s(W)?(a(),r("div",we,[s(d)?(a(),r("div",Ee,[_("header",Pe,[n($,null,{default:l(()=>[n(m,{color:"transparent"},{append:l(()=>[n(i,{size:"small",icon:"mdi-share-variant",onClick:t[0]||(t[0]=o=>ee(s(d).id))}),n(i,{size:"small",icon:s(d).status==="hide"?"mdi-eye":"mdi-eye-off",onClick:t[1]||(t[1]=o=>Z(s(d).status))},null,8,["icon"])]),_:1}),n(ie,{class:"pt-0"},{default:l(()=>[n(oe,null,{default:l(()=>[w(B(s(d).name),1)]),_:1})]),_:1}),s(N)?(a(),b(V,{key:0},{default:l(()=>[(a(!0),r(R,null,S(s(N),(o,x,A)=>(a(),b($,{key:x,class:G({"mt-4":A>0}),variant:"tonal"},{default:l(()=>[n(V,null,{default:l(()=>[_("div",Ve,[n(ae,{content:o.length,color:"accent"},{default:l(()=>[n(i,{icon:"",size:"small",class:"btn-fs-1",color:"primary"},{default:l(()=>[x==="null"?(a(),r("span",$e,[n(f,{icon:"mdi-minus"})])):(a(),r("span",Re,[n(f,{icon:F(x)},null,8,["icon"])]))]),_:2},1024)]),_:2},1032,["content"]),_("div",Be,[(a(!0),r(R,null,S(o,M=>(a(),b(se,{key:M.id},{default:l(()=>[w(B(M.name),1)]),_:2},1024))),128))])])]),_:2},1024)]),_:2},1032,["class"]))),128))]),_:1})):z("",!0)]),_:1})]),s(u)&&!s(u).some(o=>o.id===s(g))?(a(),r("form",{key:0,onSubmit:_e(X,["prevent"]),class:"mt-4"},[n(le,{modelValue:E.value,"onUpdate:modelValue":t[2]||(t[2]=o=>E.value=o),variant:"solo",label:"Ingresar como",clearable:""},{append:l(()=>[n(i,{type:"submit",color:"primary",icon:"mdi-plus",disabled:!E.value,loading:D.value},null,8,["disabled","loading"])]),_:1},8,["modelValue"])],32)):s(u)&&s(u).some(o=>o.id===s(g))?(a(),r("div",De,[_("div",je,[n(i,{color:"primary",size:"small",icon:"mdi-help",class:"btn-fs-1 ma-2",onClick:t[3]||(t[3]=o=>v("?"))}),n(i,{color:"primary",size:"small",icon:"mdi-numeric-0",class:"btn-fs-1 ma-2",onClick:t[4]||(t[4]=o=>v("0"))}),n(i,{color:"primary",size:"small",icon:"mdi-numeric-1",class:"btn-fs-1 ma-2",onClick:t[5]||(t[5]=o=>v("1"))}),n(i,{color:"primary",size:"small",icon:"mdi-numeric-2",class:"btn-fs-1 ma-2",onClick:t[6]||(t[6]=o=>v("2"))}),n(i,{color:"primary",size:"small",icon:"mdi-numeric-3",class:"btn-fs-1 ma-2",onClick:t[7]||(t[7]=o=>v("3"))}),n(i,{color:"primary",size:"small",icon:"mdi-numeric-5",class:"btn-fs-1 ma-2",onClick:t[8]||(t[8]=o=>v("5"))}),n(i,{color:"primary",size:"small",icon:"mdi-numeric-8",class:"btn-fs-1 ma-2",onClick:t[9]||(t[9]=o=>v("8"))}),n(i,{color:"primary",size:"small",icon:"mdi-plus",class:"btn-fs-1 ma-2",onClick:t[10]||(t[10]=o=>v("8+"))})])])):z("",!0),s(j)&&s(j).length?(a(),r("div",Se,[(a(!0),r(R,null,S(s(j),(o,x)=>(a(),b($,{key:o.id,class:G({"mt-4":x>0})},{default:l(()=>[n(V,null,{default:l(()=>[_("div",Ie,[_("span",null,[s(g)===s(d).id?(a(),b(i,{key:0,icon:"",size:"small",class:"btn-fs-1 mr-3",color:"accent",variant:"plain"},{default:l(()=>[n(f,{icon:"mdi-close"}),n(ce,{activator:"parent",location:"bottom",transition:"fade-transition"},{default:l(()=>[n($,{"min-width":"200"},{default:l(()=>[n(V,null,{default:l(()=>[w(" Confimar eliminación ")]),_:1}),n(re,{class:"justify-end"},{default:l(()=>[n(i,{icon:"",size:"small",variant:"text"},{default:l(()=>[n(f,{icon:"mdi-close"})]),_:1}),n(i,{icon:"",size:"small",variant:"flat",color:"primary",onClick:A=>Y(o.id)},{default:l(()=>[n(f,{icon:"mdi-check"})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)):z("",!0),o.id===s(g)?(a(),b(f,{key:1,color:"primary",size:"extrasmall",icon:"mdi-check-decagram"})):z("",!0),w(" "+B(o.name),1)]),n(i,{icon:"",size:"small",class:"btn-fs-1",color:te(s(d).status,o.estimate),variant:ne(s(d).status,o.estimate)},{default:l(()=>[s(d).status==="hide"?(a(),r("span",Ne,[o.estimate?(a(),r("span",Le,[n(f,{icon:"mdi-check-bold"})])):(a(),r("span",Te,[n(f,{icon:"mdi-dots-horizontal"})]))])):(a(),r("span",qe,[o.estimate?(a(),r("span",Ue,[n(f,{icon:F(o.estimate)},null,8,["icon"])])):(a(),r("span",Fe,[n(f,{icon:"mdi-minus"})]))]))]),_:2},1032,["color","variant"])])]),_:2},1024)]),_:2},1032,["class"]))),128))])):z("",!0)])):(a(),r("div",Ae,[n(U,{headline:"¡Error!",title:"Proyecto cerrado",text:"El proyecto al que intentas ingresar ha sido eliminado",icon:"mdi-alert-octagon",class:"my-16"})]))])):(a(),r("div",Me,[n(U,{headline:"¡Error del servidor!",title:"Error de carga de datos",text:"Se produjo un error en el servidor mientras se cargaban los datos, por favor actualice la página",icon:"mdi-alert-octagon",class:"my-16"})]))]))])])]),n(de,{modelValue:P.value,"onUpdate:modelValue":t[12]||(t[12]=o=>P.value=o),timeout:H.value},{actions:l(()=>[n(i,{icon:"mdi-close",onClick:t[11]||(t[11]=o=>P.value=!1)})]),default:l(()=>[w(B(I.value)+" ",1)]),_:1},8,["modelValue","timeout"])],64)}}});export{Je as default};
